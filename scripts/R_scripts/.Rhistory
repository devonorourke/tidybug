mat.dada2.standard <- rarefy.function(fox, Method=="dada2", Filt=="standard")
mat.dada2.extra <- rarefy.function(fox, Method=="dada2", Filt=="extra")
mat.deblur.basic <- rarefy.function(fox, Method=="deblur", Filt=="basic")
mat.deblur.standard <- rarefy.function(fox, Method=="deblur", Filt=="standard")
mat.deblur.extra <- rarefy.function(fox, Method=="deblur", Filt=="extra")
mat.vsearch.basic <- rarefy.function(fox, Method=="vsearch", Filt=="basic")
mat.vsearch.standard <- rarefy.function(fox, Method=="vsearch", Filt=="standard")
mat.vsearch.extra <- rarefy.function(fox, Method=="vsearch", Filt=="extra")
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 50, autotransform = FALSE, binary = TRUE)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df
}
## screeplot
scree.dada2.basic.dice <- screeplot.function(tmp.mat, distance = "bray", k = 6, trymax = 50, binary = TRUE)
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, distance = "bray", k = 6, trymax = 50, binary = TRUE)
scree.dada2.basic.bray <- screeplot.function(mat.dada2.basic, distance = "bray", k = 6, trymax = 50, binary = FALSE)
scree.dada2.basic.mori <- screeplot.function(mat.dada2.basic, distance = "morisita", k = 6, trymax = 50, binary = FALSE)
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 50, autotransform = FALSE, binary = TRUE, Method, Filt)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method == Method) %>% mutate(Filt == Filt)
}
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, distance = "bray", k = 6, trymax = 50, binary = TRUE)
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, distance = "bray", k = 6, trymax = 50, binary = TRUE, Method == "dada2", Filt == "basic")
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, distance = "bray", k = 6, trymax = 50, binary = TRUE, Method = "dada2", Filt = "basic")
View(scree.dada2.basic.dice)
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 50, autotransform = FALSE, binary = TRUE, Method, Filt)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method = Method) %>% mutate(Filt = Filt)
}
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, binary = TRUE, Method = "dada2", Filt = "basic")
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 20, autotransform = FALSE, binary = FALSE, Method, Filt)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method = Method) %>% mutate(Filt = Filt)
}
View(scree.dada2.basic.dice)
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, binary = TRUE, Method = "dada2", Filt = "basic")
scree.dada2.basic.bray <- screeplot.function(mat.dada2.basic, Method = "dada2", Filt = "basic")
scree.dada2.basic.mori <- screeplot.function(mat.dada2.basic, distance = "morisita")
scree.dada2.basic.mori <- screeplot.function(mat.dada2.basic, distance = "morisita", Method = "dada2", Filt = "basic")
tmp_df <- rbind(scree.dada2.basic.dice, scree.dada2.basic.bray, scree.dada2.basic.mori)
ggplot(tmp_df, aes(dim, stress, color = Method)) + geom_point()
str(tmp_df)
ggplot(tmp_df, aes(x=dim, y=stress, color = Method))
ggplot(data = tmp_df, aes(x=dims, y=stress, color=Filt)) + geom_point()
ggplot(data = tmp_df, aes(x=dims, y=stress, color=Method)) + geom_point() + geom_line()
View(tmp_df)
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 20, autotransform = FALSE, binary = FALSE, Method, Filt)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, binary = TRUE, Method = "dada2", Filt = "basic", BetaType="dice")
scree.dada2.basic.bray <- screeplot.function(mat.dada2.basic, Method = "dada2", Filt = "basic", BetaType="bray")
scree.dada2.basic.mori <- screeplot.function(mat.dada2.basic, distance = "morisita", Method = "dada2", Filt = "basic", BetaType="mori")
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 20, autotransform = FALSE, binary = FALSE, Method, Filt)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, binary = TRUE, Method = "dada2", Filt = "basic", BetaType="dice")
## screeplot function, adapted from goeveg
screeplot.function <- function (matrix, distance = "bray", k = 6, trymax = 20, autotransform = FALSE, binary = FALSE, Method, Filt, BetaType)
{
stress <- 0
for (i in 1:k) {
nmds_i <- metaMDS(matrix, distance = distance, k = i,
trymax = trymax, engine = "monoMDS", autotransform = autotransform, binary = binary)
stress[i] <- nmds_i$stress
}
stress <- print(stress)
dims <- seq(1:k)
df <- data.frame(dims, stress)
df <- df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
## screeplot
scree.dada2.basic.dice <- screeplot.function(mat.dada2.basic, binary = TRUE, Method = "dada2", Filt = "basic", BetaType="dice")
scree.dada2.basic.bray <- screeplot.function(mat.dada2.basic, Method = "dada2", Filt = "basic", BetaType="bray")
scree.dada2.basic.mori <- screeplot.function(mat.dada2.basic, distance = "morisita", Method = "dada2", Filt = "basic", BetaType="mori")
tmp_df <- rbind(scree.dada2.basic.dice, scree.dada2.basic.bray, scree.dada2.basic.mori)
ggplot(data = tmp_df, aes(x=dims, y=stress, color=BetaType)) + geom_point() + geom_line()
scree.dada2.standard.dice <- screeplot.function(mat.dada2.standard, binary = TRUE, Method = "dada2", Filt = "standard", BetaType="dice")
scree.dada2.standard.bray <- screeplot.function(mat.dada2.standard, Method = "dada2", Filt = "standard", BetaType="bray")
scree.dada2.standard.mori <- screeplot.function(mat.dada2.standard, distance = "morisita", Method = "dada2", Filt = "standard", BetaType="mori")
scree.dada2.extra.dice <- screeplot.function(mat.dada2.extra, binary = TRUE, Method = "dada2", Filt = "extra", BetaType="dice")
scree.dada2.extra.bray <- screeplot.function(mat.dada2.extra, Method = "dada2", Filt = "extra", BetaType="bray")
scree.dada2.extra.mori <- screeplot.function(mat.dada2.extra, distance = "morisita", Method = "dada2", Filt = "extra", BetaType="mori")
scree.deblur.basic.dice <- screeplot.function(mat.deblur.basic, binary = TRUE, Method = "deblur", Filt = "basic", BetaType="dice")
scree.deblur.basic.bray <- screeplot.function(mat.deblur.basic, Method = "deblur", Filt = "basic", BetaType="bray")
scree.deblur.basic.mori <- screeplot.function(mat.deblur.basic, distance = "morisita", Method = "deblur", Filt = "basic", BetaType="mori")
scree.deblur.standard.dice <- screeplot.function(mat.deblur.standard, binary = TRUE, Method = "deblur", Filt = "standard", BetaType="dice")
scree.deblur.standard.bray <- screeplot.function(mat.deblur.standard, Method = "deblur", Filt = "standard", BetaType="bray")
scree.deblur.standard.mori <- screeplot.function(mat.deblur.standard, distance = "morisita", Method = "deblur", Filt = "standard", BetaType="mori")
scree.deblur.extra.dice <- screeplot.function(mat.deblur.extra, binary = TRUE, Method = "deblur", Filt = "extra", BetaType="dice")
scree.deblur.extra.bray <- screeplot.function(mat.deblur.extra, Method = "deblur", Filt = "extra", BetaType="bray")
scree.deblur.extra.mori <- screeplot.function(mat.deblur.extra, distance = "morisita", Method = "deblur", Filt = "extra", BetaType="mori")
scree.vsearch.basic.dice <- screeplot.function(mat.vsearch.basic, binary = TRUE, Method = "vsearch", Filt = "basic", BetaType="dice")
scree.vsearch.basic.bray <- screeplot.function(mat.vsearch.basic, Method = "vsearch", Filt = "basic", BetaType="bray")
scree.vsearch.basic.mori <- screeplot.function(mat.vsearch.basic, distance = "morisita", Method = "vsearch", Filt = "basic", BetaType="mori")
scree.vsearch.standard.dice <- screeplot.function(mat.vsearch.standard, binary = TRUE, Method = "vsearch", Filt = "standard", BetaType="dice")
scree.vsearch.standard.bray <- screeplot.function(mat.vsearch.standard, Method = "vsearch", Filt = "standard", BetaType="bray")
scree.vsearch.standard.mori <- screeplot.function(mat.vsearch.standard, distance = "morisita", Method = "vsearch", Filt = "standard", BetaType="mori")
scree.vsearch.extra.dice <- screeplot.function(mat.vsearch.extra, binary = TRUE, Method = "vsearch", Filt = "extra", BetaType="dice")
scree.vsearch.extra.bray <- screeplot.function(mat.vsearch.extra, Method = "vsearch", Filt = "extra", BetaType="bray")
scree.vsearch.extra.mori <- screeplot.function(mat.vsearch.extra, distance = "morisita", Method = "vsearch", Filt = "extra", BetaType="mori")
tmp_df <- do.call("rbind", list=ls(pattern = "scree.*"))
dflist <- ls(pattern = "scree.*")
tmp_df <- do.call("rbind", list=dflist)
str(dflist)
dflist <- as.list(ls(pattern = "scree.*"))
str(dflist)
tmp_df <- do.call("rbind", dflist)
View(tmp_df)
tmp_df <- do.call("rbind", list(dflist))
View(tmp_df)
dflist <- ls(pattern = "scree.*")
tmp_df <- do.call("rbind", list(dflist))
tmp_df <- do.call("rbind", dflist)
tmp_df <- mget(dflist) %>% bind_rows()
tmp_df <- docall(rbind, mget(dflist))
tmp_df <- do.call(rbind, mget(dflist))
tmp_df <- do.call('rbind', mget(dflist))
tmp_df <- do.call("rbind", mget(ls(pattern = "scree.*")))
tmp_df <- do.call("rbind", mget(ls(pattern = "scree*")))
dflist <- ls(pattern = "scree.*")
dflist
dflist <- ls(pattern = "scree\\.*")
dflist
dflist <- ls(pattern = "scree\\..*")
dflist
tmp_df <- do.call("rbind", mget(ls(pattern = "scree\\.*")))
tmp_df <- do.call("rbind", mget(dflist))
tmp_df <- do.call("rbind", mget(ls(pattern = "scree\\..*")))
head(tmp_df)
## plot
ggplot(data = tmp_df, aes(x=dims, y=stress, color=BetaType)) +
geom_point() + geom_line() +
facet_grid(Method ~ Filt)
## plot
ggplot(data = tmp_df, aes(x=dims, y=stress, color=BetaType)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.15, linetype = "dashed", color = "red") +
facet_grid(Method ~ Filt)
## plot
ggplot(data = tmp_df, aes(x=dims, y=stress, color=BetaType)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.15, linetype = "dashed", color = "red") +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ Filt)
## plot
ggplot(data = tmp_df, aes(x=dims, y=stress, color=Filt)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.15, linetype = "dashed", color = "red") +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ BetaType)
## combine all scree plot data
scree_df <- do.call("rbind", mget(ls(pattern = "scree\\..*")))
rm(tmp_df)
## set levels
scree_df$Filt <- factor(scree_df$Filt, levels = c("basic", "standard", "extra"))
scree_df$BetaType <- factor(scree_df$BetaType, levels = c("dice", "bray", "mori"))
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.15, linetype = "dashed", color = "red") +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ BetaType)
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.1, linetype = "dashed", color = "red") +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ BetaType)
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_point() + geom_line() + geom_hline(yintercept = 0.1, linetype = "dashed", color = "firebrick", alpha=0.5) +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ BetaType)
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_hline(yintercept = 0.1, linetype = "dashed", color = "firebrick", alpha=0.5) +
geom_line(alpha=0.5) +
geom_point() +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
facet_grid(Method ~ BetaType)
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_hline(yintercept = 0.1, linetype = "dashed", color = "firebrick", alpha=0.5) +
geom_line(alpha=0.5) +
geom_point() +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
scale_x_continuous(breaks = c(seq(1:6))) +
facet_grid(Method ~ BetaType)
theme_devon <- function () {
theme_bw(base_size=12, base_family="Avenir") %+replace%
theme(
panel.background  = element_blank(),
plot.background = element_rect(fill="transparent", colour=NA),
legend.background = element_rect(fill="transparent", colour=NA),
legend.key = element_rect(fill="transparent", colour=NA)
)
}
## plot
ggplot(data = scree_df, aes(x=dims, y=stress, color=Filt)) +
geom_hline(yintercept = 0.1, linetype = "dashed", color = "firebrick", alpha=0.5) +
geom_line(alpha=0.5) +
geom_point() +
scale_color_manual(values = c('#9f9244', '#6c42b8', '#628a47')) +
#scale_x_continuous(breaks = c(seq(1:6))) +
facet_grid(Method ~ BetaType)  +
labs(x="dimensions", y="stress", color = "Filtering\nParameter") +
theme_devon() +
theme(legend.position="top")
rm(ls(pattern = "scree\\..*"))
rm(list=ls(pattern = "scree\\..*"))
## calculate distances
dist.dada2.basic.dice <- vegdist(mat.dada2.basic, method = "bray", binary = TRUE)
dist.dada2.basic.bray <- vegdist(mat.dada2.basic, method = "bray", binary = FALSE)
dist.dada2.basic.mori <- vegdist(mat.dada2.basic, method = "morisita", binary = FALSE)
## calculate distances and run NMDS for each Filt, Method, Betatest
nmdsfunction.function <- function(data, test, binaryval, Method, Filt, BetaType) {
tmp.dist <- vegdist(data, method = test, binary = binaryval)
tmp.nmds <- metaMDS(tmp.dist, k=3, try=30)
tmp.nmds.df <- data.frame(tmp.nmds$points)
tmp.nmds.df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
nmds.dada2.basic.dice <- nmdsfunction.function(mat.dada2.basic, "bray", TRUE, "dada2", "basic", "dice")
View(nmds.dada2.basic.dice)
nmds.dada2.basic.bray <- nmdsfunction.function(mat.dada2.basic, "bray", FALSE, "dada2", "basic", "bray")
nmds.dada2.basic.mori <- nmdsfunction.function(mat.dada2.basic, "morisita", FALSE, "dada2", "basic", "mori")
nmds.dada2.basic.dice <- nmdsfunction.function(mat.dada2.basic, "bray", TRUE, "dada2", "basic", "dice")
nmds.dada2.basic.bray <- nmdsfunction.function(mat.dada2.basic, "bray", FALSE, "dada2", "basic", "bray")
nmds.dada2.basic.mori <- nmdsfunction.function(mat.dada2.basic, "morisita", FALSE, "dada2", "basic", "mori")
nmds.dada2.standard.dice <- nmdsfunction.function(mat.dada2.standard, "bray", TRUE, "dada2", "standard", "dice")
nmds.dada2.standard.bray <- nmdsfunction.function(mat.dada2.standard, "bray", FALSE, "dada2", "standard", "bray")
nmds.dada2.standard.mori <- nmdsfunction.function(mat.dada2.standard, "morisita", FALSE, "dada2", "standard", "mori")
nmds.dada2.extra.dice <- nmdsfunction.function(mat.dada2.extra, "bray", TRUE, "dada2", "extra", "dice")
nmds.dada2.extra.bray <- nmdsfunction.function(mat.dada2.extra, "bray", FALSE, "dada2", "extra", "bray")
nmds.dada2.extra.mori <- nmdsfunction.function(mat.dada2.extra, "morisita", FALSE, "dada2", "extra", "mori")
nmds.deblur.basic.dice <- nmdsfunction.function(mat.deblur.basic, "bray", TRUE, "deblur", "basic", "dice")
nmds.deblur.basic.bray <- nmdsfunction.function(mat.deblur.basic, "bray", FALSE, "deblur", "basic", "bray")
nmds.deblur.basic.mori <- nmdsfunction.function(mat.deblur.basic, "morisita", FALSE, "deblur", "basic", "mori")
nmds.deblur.standard.dice <- nmdsfunction.function(mat.deblur.standard, "bray", TRUE, "deblur", "standard", "dice")
nmds.deblur.standard.bray <- nmdsfunction.function(mat.deblur.standard, "bray", FALSE, "deblur", "standard", "bray")
nmds.deblur.standard.mori <- nmdsfunction.function(mat.deblur.standard, "morisita", FALSE, "deblur", "standard", "mori")
nmds.deblur.extra.dice <- nmdsfunction.function(mat.deblur.extra, "bray", TRUE, "deblur", "extra", "dice")
nmds.deblur.extra.bray <- nmdsfunction.function(mat.deblur.extra, "bray", FALSE, "deblur", "extra", "bray")
nmds.deblur.extra.mori <- nmdsfunction.function(mat.deblur.extra, "morisita", FALSE, "deblur", "extra", "mori")
nmds.vsearch.basic.dice <- nmdsfunction.function(mat.vsearch.basic, "bray", TRUE, "vsearch", "basic", "dice")
nmds.vsearch.basic.bray <- nmdsfunction.function(mat.vsearch.basic, "bray", FALSE, "vsearch", "basic", "bray")
nmds.vsearch.basic.mori <- nmdsfunction.function(mat.vsearch.basic, "morisita", FALSE, "vsearch", "basic", "mori")
nmds.vsearch.standard.dice <- nmdsfunction.function(mat.vsearch.standard, "bray", TRUE, "vsearch", "standard", "dice")
nmds.vsearch.standard.bray <- nmdsfunction.function(mat.vsearch.standard, "bray", FALSE, "vsearch", "standard", "bray")
nmds.vsearch.standard.mori <- nmdsfunction.function(mat.vsearch.standard, "morisita", FALSE, "vsearch", "standard", "mori")
nmds.vsearch.extra.dice <- nmdsfunction.function(mat.vsearch.extra, "bray", TRUE, "vsearch", "extra", "dice")
nmds.vsearch.extra.bray <- nmdsfunction.function(mat.vsearch.extra, "bray", FALSE, "vsearch", "extra", "bray")
nmds.vsearch.extra.mori <- nmdsfunction.function(mat.vsearch.extra, "morisita", FALSE, "vsearch", "extra", "mori")
## combine all scree plot data
nmds_df <- do.call("rbind", mget(ls(pattern = "nmds\\..*")))
head(nmds_df)
## join metadata of MonthStart
tmp.fox.meta <- fox %>% distinct(SeqID, MonthStart)
View(tmp.fox.meta)
View(nmds_df)
View(mat.vsearch.basic)
## calculate distances and run NMDS for each Filt, Method, Betatest
nmdsfunction.function <- function(data, test, binaryval, Method, Filt, BetaType) {
tmp.dist <- vegdist(data, method = test, binary = binaryval)
tmp.nmds <- metaMDS(tmp.dist, k=3, try=30)
tmp.nmds.df <- data.frame(tmp.nmds$points)
tmp.nmds.df$SeqID <- row.names(tmp.nmds)
tmp.nmds.df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
nmds.dada2.basic.dice <- nmdsfunction.function(mat.dada2.basic, "bray", TRUE, "dada2", "basic", "dice")
View(nmds.dada2.basic.dice)
tmp.dist <- vegdist(mat.dada2.basic, method="bray", binary = TRUE)
tmp.nmds <- metaMDS(tmp.dist, k=3, try=30)
tmp.nmds.df <- data.frame(tmp.nmds$points)
tmp.nmds$data
tmp.nmds$species
View(tmp.nmds.df)
## calculate distances and run NMDS for each Filt, Method, Betatest
nmdsfunction.function <- function(data, test, binaryval, Method, Filt, BetaType) {
tmp.dist <- vegdist(data, method = test, binary = binaryval)
tmp.nmds <- metaMDS(tmp.dist, k=3, try=30)
tmp.nmds.df <- data.frame(tmp.nmds$points)
tmp.nmds.df$SeqID <- row.names(tmp.nmds.df)
tmp.nmds.df %>% mutate(Method = Method) %>% mutate(Filt = Filt) %>% mutate(BetaType = BetaType)
}
nmds.dada2.basic.dice <- nmdsfunction.function(mat.dada2.basic, "bray", TRUE, "dada2", "basic", "dice")
nmds.dada2.basic.bray <- nmdsfunction.function(mat.dada2.basic, "bray", FALSE, "dada2", "basic", "bray")
nmds.dada2.basic.mori <- nmdsfunction.function(mat.dada2.basic, "morisita", FALSE, "dada2", "basic", "mori")
nmds.dada2.standard.dice <- nmdsfunction.function(mat.dada2.standard, "bray", TRUE, "dada2", "standard", "dice")
nmds.dada2.standard.bray <- nmdsfunction.function(mat.dada2.standard, "bray", FALSE, "dada2", "standard", "bray")
nmds.dada2.standard.mori <- nmdsfunction.function(mat.dada2.standard, "morisita", FALSE, "dada2", "standard", "mori")
nmds.dada2.extra.dice <- nmdsfunction.function(mat.dada2.extra, "bray", TRUE, "dada2", "extra", "dice")
nmds.dada2.extra.bray <- nmdsfunction.function(mat.dada2.extra, "bray", FALSE, "dada2", "extra", "bray")
nmds.dada2.extra.mori <- nmdsfunction.function(mat.dada2.extra, "morisita", FALSE, "dada2", "extra", "mori")
nmds.deblur.basic.dice <- nmdsfunction.function(mat.deblur.basic, "bray", TRUE, "deblur", "basic", "dice")
nmds.deblur.basic.bray <- nmdsfunction.function(mat.deblur.basic, "bray", FALSE, "deblur", "basic", "bray")
nmds.deblur.basic.mori <- nmdsfunction.function(mat.deblur.basic, "morisita", FALSE, "deblur", "basic", "mori")
nmds.deblur.standard.dice <- nmdsfunction.function(mat.deblur.standard, "bray", TRUE, "deblur", "standard", "dice")
nmds.deblur.standard.bray <- nmdsfunction.function(mat.deblur.standard, "bray", FALSE, "deblur", "standard", "bray")
nmds.deblur.standard.mori <- nmdsfunction.function(mat.deblur.standard, "morisita", FALSE, "deblur", "standard", "mori")
nmds.deblur.extra.dice <- nmdsfunction.function(mat.deblur.extra, "bray", TRUE, "deblur", "extra", "dice")
nmds.deblur.extra.bray <- nmdsfunction.function(mat.deblur.extra, "bray", FALSE, "deblur", "extra", "bray")
nmds.deblur.extra.mori <- nmdsfunction.function(mat.deblur.extra, "morisita", FALSE, "deblur", "extra", "mori")
nmds.vsearch.basic.dice <- nmdsfunction.function(mat.vsearch.basic, "bray", TRUE, "vsearch", "basic", "dice")
nmds.vsearch.basic.bray <- nmdsfunction.function(mat.vsearch.basic, "bray", FALSE, "vsearch", "basic", "bray")
nmds.vsearch.basic.mori <- nmdsfunction.function(mat.vsearch.basic, "morisita", FALSE, "vsearch", "basic", "mori")
nmds.vsearch.standard.dice <- nmdsfunction.function(mat.vsearch.standard, "bray", TRUE, "vsearch", "standard", "dice")
nmds.vsearch.standard.bray <- nmdsfunction.function(mat.vsearch.standard, "bray", FALSE, "vsearch", "standard", "bray")
nmds.vsearch.standard.mori <- nmdsfunction.function(mat.vsearch.standard, "morisita", FALSE, "vsearch", "standard", "mori")
nmds.vsearch.extra.dice <- nmdsfunction.function(mat.vsearch.extra, "bray", TRUE, "vsearch", "extra", "dice")
nmds.vsearch.extra.bray <- nmdsfunction.function(mat.vsearch.extra, "bray", FALSE, "vsearch", "extra", "bray")
nmds.vsearch.extra.mori <- nmdsfunction.function(mat.vsearch.extra, "morisita", FALSE, "vsearch", "extra", "mori")
## combine all scree plot data
nmds_df <- do.call("rbind", mget(ls(pattern = "nmds\\..*")))
rm(tmp.fox.meta)
rm(tmp.nmds)
rm(tmp.nmds.df)
rm(nmds_df)
test <- ls(pattern = "nmds\\..*")
## combine all scree plot data
nmds_df <- do.call("rbind", mget(ls(pattern = "nmds\\..*")))
## join metadata of MonthStart
tmp.fox.meta <- fox %>% distinct(SeqID, MonthStart)
View(nmds_df)
View(tmp.fox.meta)
nmds_df <-
tmp <- merge(nmds_df, tmp.fox.meta, by.x="SeqID", by.y="SeqID", all.x=TRUE)
nmds_df <- merge(nmds_df, tmp.fox.meta, by.x="SeqID", by.y="SeqID", all.x=TRUE)
rm(tmp)
rm(tmp.fox.meta)
View(nmds_df)
## combine all scree plot data
nmds_df <- do.call("rbind", mget(ls(pattern = "nmds\\..*")))
## join metadata of MonthStart
tmp.fox.meta <- fox %>% distinct(SeqID, MonthStart)
nmds_df <- merge(nmds_df, tmp.fox.meta, by.x="SeqID", by.y="SeqID", all.x=TRUE)
rm(tmp.fox.meta)
facet_grid(Filt ~ Method)
## plot
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method)
rm(list=ls(pattern = "scree\\..*"))
rm(list=ls(pattern = "nmds\\..*")))
rm(list=ls(pattern = "nmds\\..*"))
montpal <- c('#d7191c', '#fdae61', '#abdda4', '#2b83ba)
montpal <- c('#d7191c', '#fdae61', '#abdda4', '#2b83ba')
montpal <- c('#d7191c', '#fdae61', '#abdda4', '#2b83ba')
rm(montpal)
monthpal <- c('#d7191c', '#fdae61', '#abdda4', '#2b83ba')
## plots are separated by BetaTest
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', caption = "Dice-Sorensen index used to calculate distnaces") +
theme_devon() + theme(legend.position = "top")
rev(monthpal)
monthpal <- c("#2b83ba", "#abdda4", "#fdae61", "#d7191c")
## plots are separated by BetaTest
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', caption = "Dice-Sorensen index used to calculate distnaces") +
theme_devon() + theme(legend.position = "top")
## set levels for plot
nmds_df$MonthStart <- factor(nmds_df$MonthStart, levels = c("April", "May", "September", "October"))
nmds_df$Filt <- factor(nmds_df$Filt, levels = c("basic", "standard", "extra"))
## plots are separated by BetaTest
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', caption = "Dice-Sorensen index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
## plots are separated by BetaTest
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Dice-Sorensen index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
ggplot(data=nmds_df %>% filter(BetaType=="bray"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Bray-Curtis index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
ggplot(data=nmds_df %>% filter(BetaType=="mori"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Morisita-Horn index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
## plots are separated by BetaTest
## save as 16_FOX_nmds_dice; export at
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Dice-Sorensen index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
ggplot(data=nmds_df %>% filter(BetaType=="bray"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Bray-Curtis index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
ggplot(data=nmds_df %>% filter(BetaType=="mori"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Morisita-Horn index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
## plots are separated by BetaTest
## save as 16_FOX_nmds_dice; export at
ggplot(data=nmds_df %>% filter(BetaType=="dice"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Dice-Sorensen index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
## save as 16_FOX_nmds_dice; export at 700x700
ggplot(data=nmds_df %>% filter(BetaType=="bray"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Bray-Curtis index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
## save as 16_FOX_nmds_mori; export at 700x700
ggplot(data=nmds_df %>% filter(BetaType=="mori"),
aes(x=MDS1, y=MDS2, color = MonthStart)) +
geom_point() +
facet_grid(Filt ~ Method) +
scale_color_manual(values = monthpal) +
labs(x='mds1', y='mds2', subtitle = "Morisita-Horn index used to calculate distnaces", color = "") +
theme_devon() + theme(legend.position = "top")
